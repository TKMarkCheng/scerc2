!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="1ccbfeef-6181-485d-a2a4-a02ed3a949d8",e._sentryDebugIdIdentifier="sentry-dbid-1ccbfeef-6181-485d-a2a4-a02ed3a949d8")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"89a07b1e7745510a293cee75fcd45a9a9cc87c53"},(self.webpackChunkcovidence=self.webpackChunkcovidence||[]).push([[34],{10474:function(){window.Covidence||(window.Covidence={}),_.extend(window.Covidence,Backbone.Events),Covidence.Application={initialize:function(e){return this.feedbackView=new Covidence.FeedbackView(e),this.feedbackView.render(),this.setupErrorHooks(),Covidence.on("unauthorized",this.redirectToLogin)},setupErrorHooks:function(){return $(window.document).ajaxComplete((e=this,function(t,n,o){switch(n.status){case 401:return e.redirectToLogin.apply(e,arguments);case 400:case 403:case 500:return e.showError.apply(e,arguments)}}));var e},showError:function(e,t,n){var o;return o=new Covidence.SystemErrorView({model:{event:e,response:t,options:n}}),$("body #ajax-error-view").remove(),$("body").prepend(o.render().el)},redirectToLogin:function(e,t,n){return window.location.href="/sign_in"}},Covidence.Utils={pluralize:function(e,t){return e+" "+pluralize(t,e)}}},28200:function(){var e={}.hasOwnProperty;Covidence.Account=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Covidence.RelationalModel),n.prototype.relations=[{type:Backbone.HasOne,key:"current_plan",relatedModel:"Covidence.Plan",collectionType:"Covidence.Plans"}],n.prototype.canPurchasePlan=function(e){return!this.hasReviewsRemaining()||!0===e.get("custom")||null==this.get("current_plan")||e.get("price")>this.get("current_plan").get("price")},n.prototype.canCreateReview=function(e){return void 0!==e.get("external_reference")||this.get("available_review_count")>0},n.prototype.hasReviewsRemaining=function(){var e;return null==(e=this.get("available_review_count"))&&(e=Infinity),e>0},n.prototype.planUpgradeMotivation=function(){var e;return(null!=(e=this.get("current_plan"))?e.get("introductory"):void 0)?"Thanks for helping us shape Covidence in the early years. You can continue to work on your existing reviews, but if you need to create new reviews, you will need to purchase a plan.":null==this.get("current_plan")||this.hasReviewsRemaining()?void 0:"You have no more reviews left on your current plan, either due to expiry of your subscription or due to exhausting your review allowance. Choose a new plan to create further reviews."},n}()},92714:function(){var e=function(e,n){for(var o in n)t.call(n,o)&&(e[o]=n[o]);function r(){this.constructor=e}return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty;Covidence.AuditEvent=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.dateCreated=function(){return this.get("created_at")},n.prototype.displayClass=function(){return this.get("name").replace(/^(covidence|regroup)\b/,"event").replace(/\./g,"-")},n}(Covidence.RelationalModel),Covidence.AuditEvents=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Covidence.AuditEvent,n.prototype.comparator="created_at",n}(Backbone.Collection)},83630:function(){var e={}.hasOwnProperty;Covidence.Collection=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.Collection),n.prototype.initialize=function(e,t){if(n.__super__.initialize.apply(this,arguments),t&&t.url)return this.url=t.url},n}()},29513:function(){var e=function(e,n){for(var o in n)t.call(n,o)&&(e[o]=n[o]);function r(){this.constructor=e}return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty;Covidence.Country=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n}(Backbone.Model),Covidence.Countries=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Covidence.Country,n}(Backbone.Collection)},6784:function(){var e={}.hasOwnProperty;Covidence.CreditCard=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.Model),n.prototype.defaults={number:"",name:"",expiry_month:"",expiry_year:"",cvc:"",address_line1:"",address_city:"",address_country:""},n}()},89390:function(){var e={}.hasOwnProperty;Covidence.Document=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Covidence.RelationalModel),n.prototype.initialize=function(e){return n.__super__.initialize.call(this),this.file=e.file,this.set("upload_file_name",this.file.name),"type"in this.file&&this.set("upload_content_type",this.file.type),"size"in this.file&&this.set("upload_file_size",this.file.size),"lastModifiedDate"in this.file&&this.set("upload_updated_at",this.file.lastModifiedDate),this},n}()},96660:function(){var e,t=function(e,t){for(var o in t)n.call(t,o)&&(e[o]=t[o]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},n={}.hasOwnProperty;e=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.name="BackboneModelError",n}(Error),Covidence.RelationalModel=function(n){function o(){return o.__super__.constructor.apply(this,arguments)}return t(o,n),o.prototype.initialize=function(e){return o.__super__.initialize.apply(this,arguments),this.listenTo(this,"error",this.handleError),this.listenTo(this,"request",this.handleRequest),this.listenTo(this,"sync",this.handleSync),this.listenTo(this,"change:url",this.setUrl)},o.prototype.handleError=function(t,n,o){return[502,503,504].lastIndexOf(n.status)>=0?Covidence.trigger("error",t,n,o):[422,409].lastIndexOf(n.status)>=0&&void 0!==n.responseJSON.errors?(this.trigger("invalid",this,n.responseJSON.errors,o),t.collection&&t.collection.trigger("invalid",t.collection,n.responseJSON.errors,o),Covidence.trigger("error",t,n,o)):MetaError.notify(new e(n.responseText),{context:{model:{name:t.constructor.name||t.constructor.toString(),url:"function"==typeof t.url?t.url():void 0,data:t.toJSON()}}})},o.prototype.handleRequest=function(e,t,n){return Covidence.trigger("saving",e,t,n),this},o.prototype.handleSync=function(e,t,n){return Covidence.trigger("saved",e,t,n),this},o.prototype.setUrl=function(e,t,n){return this.url=this.get("url"),this.unset("url",{silent:!0}),this},o}(Backbone.RelationalModel)},81006:function(){var e=function(e,n){for(var o in n)t.call(n,o)&&(e[o]=n[o]);function r(){this.constructor=e}return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty;Covidence.Note=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.urlRoot="/api/v1/notes",n.prototype.dateCreated=function(){return this.get("created_at")},n.prototype.validate=function(e){if(!e.note)return{note:["Note is required"]}},n}(Covidence.RelationalModel),Covidence.Notes=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Covidence.Note,n.prototype.url="/api/v1/notes",n.prototype.comparator="created_at",n}(Backbone.Collection)},67624:function(){var e={}.hasOwnProperty;Covidence.Payment=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Covidence.RelationalModel),n.prototype.urlRoot="/payments",n.prototype.isComplete=function(){return"complete"===this.get("status")},n.prototype.isFailure=function(){return"failed"===this.get("status")},n.prototype.finishedProcessing=function(){return null!==this.get("status")},n}()},8741:function(){var e={}.hasOwnProperty;Covidence.PaymentService=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Covidence.RelationalModel),n}()},53238:function(){var e=function(e,n){for(var o in n)t.call(n,o)&&(e[o]=n[o]);function r(){this.constructor=e}return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty;Covidence.Promotion=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n}(Covidence.RelationalModel),Covidence.Promotions=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Covidence.Promotion,n}(Covidence.Collection)},81812:function(){var e=function(e,n){for(var o in n)t.call(n,o)&&(e[o]=n[o]);function r(){this.constructor=e}return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty;Covidence.ReviewStatistics=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.remote=!0,n.prototype.detail=function(e,t){var n;return(n=new Covidence.ReviewDetailedStatistics).baseUrl=this.url,n.category=e,n},n}(Backbone.Model),Covidence.ReviewDetailedStatistics=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.remote=!0,n.prototype.url=function(){return this.baseUrl+"/detailed?category="+this.category},n.prototype.percentageFor=function(e){return 100*this.calculatePercentage(this.get(e))},n.prototype.totalProgress=function(){return this.get("complete")+this.get("partially_complete")+this.get("consensus_required")+this.get("not_started")},n.prototype.calculatePercentage=function(e){return 0===this.totalProgress()?0:e/this.totalProgress()},n.prototype.isComplete=function(){return this.get("consensus_required")+this.get("available")===0},n.prototype.notStarted=function(){return 0===this.totalProgress()},n}(Backbone.Model)},41303:function(){var e=function(e,n){for(var o in n)t.call(n,o)&&(e[o]=n[o]);function r(){this.constructor=e}return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty;Covidence.Reviewer=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.fullName=function(){return this.get("first_name")+" "+this.get("last_name")},n.prototype.allowPermission=function(e,t){return!this.denyPermission(e,t)},n.prototype.denyPermission=function(e,t){var n,o;return!!(o=e.get("permissions").findWhere({id:t}))&&((n=o.get("member_ids")).length>0&&!_.contains(n,this.get("id")))},n.prototype.showRoBInstruction=function(){return!!this.get("show_rob_instruction")},n.calculatedProperties=["fullName"],n}(Covidence.RelationalModel),Covidence.Reviewers=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Covidence.Reviewer,n}(Backbone.Collection)},55768:function(){Covidence.UserPreferences=function(){var e,t;function n(){}return _.extend(n,Backbone.Events),t=null,e=function(){function e(){}return e.preferences={keywordHighlightingEnabled:"keywordHighlightingEnabled"},e.prototype.storageNamespace="covidence.userPreferences",e.prototype.set=function(e,t){return localStorage[this.keyify(e)]=t,Covidence.UserPreferences.trigger("change")},e.prototype.get=function(e){return localStorage.getItem(this.keyify(e))},e.prototype.keyify=function(e){return this.storageNamespace+"."+e},e}(),n.datastore=function(){return null!=t?t:t=new e},n.isKeywordHighlightingEnabled=function(){return"1"===this.datastore().get(e.preferences.keywordHighlightingEnabled)},n.toggleKeywordHighlighting=function(){return this.isKeywordHighlightingEnabled()?this.disableKeywordHighlighting():this.enableKeywordHighlighting()},n.enableKeywordHighlighting=function(){return this.datastore().set(e.preferences.keywordHighlightingEnabled,"1")},n.disableKeywordHighlighting=function(){return this.datastore().set(e.preferences.keywordHighlightingEnabled,"0")},n}()},43016:function(){window.Util={shortReason:function(){return 35,this.reason.length>35?this.reason.substring(0,35)+"...":this.reason}}},23447:function(){Covidence.BrowserNotificationController={initialize:function(){var e;return this.el=$("#browser-notification-view"),this.el.find("a.ss-delete").on("click",(e=this,function(){return e.hide()})),this.show()},hide:function(){return this.el.hide(),$.cookie("browser-notification","seen",{expires:30})},show:function(){if(this.notify())return this.el.show()},notify:function(){return Covidence.unsupportedBrowser&&!$.cookie("browser-notification")}}},84299:function(){var e={}.hasOwnProperty;Covidence.DismissableMessageView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.View),n.prototype.className="alert",n.prototype.events={"click .close":"close"},n.prototype.initialize=function(e){return this.template=HandlebarsTemplates.message,this.message=e.message,this.status=e.status||"success"},n.prototype.render=function(){return this.$el.html(this.template({message:this.message})),this.$el.addClass("alert-"+this.status),this},n.prototype.close=function(){return this.remove()},n}()},57270:function(){var e={}.hasOwnProperty;Covidence.FeedbackView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.View),n.prototype.id="feedback-and-support",n.prototype.className="modal",n.prototype.events={"click a.cancel":"closeModal","click a.done":"closeModal","click a.submit":"saveFeedbackForm","click a.show-form":"loadFeedbackForm","hidden.bs.modal":"render"},n.prototype.template="<div class='modal-dialog'>\n  <div class='modal-content'>\n    <div class='modal-header'>\n      <h3>Feedback & Support</h3>\n    </div>\n    <div class='modal-body'>\n      <h4>Find your answer, fast.</h4>\n      <p>We've got a new Knowledge base that answers many frequently asked questions. Why not try that first?</p>\n      <a href=\"{{knowledgeBaseUrl}}\" class=\"button primary highlight\" target='_blank'>View the knowledge base</a>\n      <span>OR</span>\n      <a href=\"javascript:void(0)\" class=\"inline show-form\">Send us an email</a>\n    </div>\n    <div class='modal-footer'>\n      <a class='cancel pull-left action-link'>Cancel</a>\n      <a href=\"#\" class=\"button primary right action submit\">Submit</a>\n      <a class='done button pull-right primary action' style='display: none;'>Close</a>\n    </div>\n  </div>\n</div>",n.prototype.initialize=function(e){return this.attributes=_.pick(e||{},"showUrl","postUrl","knowledgeBaseUrl")},n.prototype.render=function(){return this.$el.empty(),this.$el.append($.mustache(this.template,{knowledgeBaseUrl:this.attributes.knowledgeBaseUrl})),$("body").append(this.el),this.$(".modal-footer").hide(),this},n.prototype.loadFeedbackForm=function(e){return $.get(this.attributes.showUrl,(t=this,function(e){return t.$(".modal-footer").show(),t.$(".modal-body").html(e)}));var t},n.prototype.saveFeedbackForm=function(e){return e.preventDefault(),$.post(this.attributes.postUrl,this.$("form").serialize(),(t=this,function(e){return t.$("a.submit").hide(),t.$(".modal-body").html(e)}));var t},n.prototype.closeModal=function(){return this.$el.modal("hide"),$(".nav-item.support a").blur()},n}()},26392:function(){var e={}.hasOwnProperty;Covidence.PlanInclusionsView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.View),n.prototype.className="inclusions row",n.prototype.initialize=function(){return this.template=HandlebarsTemplates["plans/inclusions"]},n.prototype.render=function(){var e,t;return this.$el.html(this.template()),e=Math.ceil(this.collection.length/2),_(this.collection).each((t=this,function(n,o){var r;return r=o<e?"list-1":"list-2",t.$el.find("."+r).append(new Covidence.InclusionView({model:n}).render().el)})),this},n}()},2327:function(){var e={}.hasOwnProperty;Covidence.PlanPaymentFailureView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.View),n.prototype.className="payment-failure",n.prototype.events={"click .start-again":"start_again","click .return-home":"return_home"},n.prototype.initialize=function(e){return this.payment=this.model.get("payment"),this.template=HandlebarsTemplates["plans/payment_failure"]},n.prototype.render=function(){var e,t;return t=(e=null!==this.payment.get("fatal_errors"))?"This could be for a number of reasons, sorry we can’t be more specific. We haven’t been notified of a successful/unsuccessful payment. We recommend you contact your financial institution before trying again.":this.payment.get("reportable_errors"),this.$el.html(this.template({message:t,isFatal:e})),this},n.prototype.return_home=function(){return this.model.trigger("abort")},n.prototype.start_again=function(){return this.model.trigger("start")},n}()},1971:function(){var e={}.hasOwnProperty;Covidence.PlanPaymentStatusView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.View),n.prototype.className="payment-status",n.prototype.initialize=function(e){return this.payment=this.model.get("payment"),this.listenTo(this.payment,"sync",this.refresh),this.template=HandlebarsTemplates["plans/payment_status"]},n.prototype.render=function(){return this.$el.html(this.template()),this.pollPayment(),this},n.prototype.refresh=function(){return!0===this.payment.isComplete()?(clearInterval(this.poll),this.model.trigger("paymentSuccess")):!0===this.payment.isFailure()&&(clearInterval(this.poll),this.model.trigger("paymentFailure")),this},n.prototype.pollPayment=function(){var e;return this.poll=setInterval((e=this,function(){return $.contains(document,e.$el[0])?e.payment.fetch():clearInterval(e.poll)}),5e3),this},n}()},86711:function(){var e={}.hasOwnProperty;Covidence.PlanPaymentSuccessView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.View),n.prototype.className="payment-success",n.prototype.events={"click .continue":"continue"},n.prototype.initialize=function(e){return this.payment=this.model.get("payment"),this.selectedPlan=this.model.get("selected_plan"),this.template=HandlebarsTemplates["plans/payment_success"]},n.prototype.render=function(){var e,t;return t=Covidence.Utils.pluralize(this.selectedPlan.get("number_of_reviews"),"review"),e=this.template({planName:this.selectedPlan.get("name"),numberOfReviews:t}),this.$el.html(e),this},n.prototype.continue=function(){return this.model.trigger("complete",this.selectedPlan.get("name"))},n}()},75117:function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty;Covidence.PlanPaymentView=function(n){function o(){return this.handleError=e(this.handleError,this),this.handleSuccess=e(this.handleSuccess,this),this.purchasePlan=e(this.purchasePlan,this),o.__super__.constructor.apply(this,arguments)}return function(e,n){for(var o in n)t.call(n,o)&&(e[o]=n[o]);function r(){this.constructor=e}r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype}(o,Backbone.View),o.prototype.className="plan-payment",o.prototype.events={"click .pay":"purchasePlan","click .cancel":"cancelPurchase"},o.prototype.bindings={"#address_line1":"address_line1","#address_city":"address_city","#address_country":{observe:"address_country",selectOptions:{collection:"this.countries",labelPath:"name",valuePath:"code",defaultOption:{label:"",value:null}}},"#number":"number","#name":"name","#expiry_month":{observe:"expiry_month",selectOptions:{collection:[1,2,3,4,5,6,7,8,9,10,11,12],defaultOption:{label:"",value:null}}},"#expiry_year":{observe:"expiry_year",selectOptions:{collection:"this.expiryYears",defaultOption:{label:"",value:null}}},"#cvc":"cvc"},o.prototype.initialize=function(e){var t;return this.reviewer=Covidence.reviewer,this.promotions=e.promotions,this.countries=Covidence.countries,t=(new Date).getFullYear(),this.expiryYears=_(12).times((function(e){return t+e})),this.creditCard=new Covidence.CreditCard({name:this.reviewer.fullName(),expiry_year:t,expiry_month:(new Date).getMonth()+1}),this.template=HandlebarsTemplates["plans/payment"],this.model.unset("discounted_price",{silent:!0}),this.listenTo(this.model,"change:discounted_price",this.applyDiscountedPrice),this},o.prototype.render=function(){var e,t,n;return e={planName:(n=this.model.get("selected_plan")).get("name"),planPrice:accounting.formatMoney(n.get("price"),{precision:0}),numberOfReviews:Covidence.Utils.pluralize(n.get("number_of_reviews"),"review")},this.$el.html(this.template(e)),t=new Covidence.PromotionView({collection:this.promotions,model:this.model}).render(),this.$(".header").append(t.el),this.stickit(this.creditCard),this},o.prototype.applyDiscountedPrice=function(e,t){var n;return n=t%1!=0?2:0,this.$(".plan-price").html(accounting.formatMoney(t,{precision:n})),this.$(".original-price").html(accounting.formatMoney(e.get("selected_plan").get("price"),{precision:0})),this},o.prototype.purchasePlan=function(){return this.clearErrorMessages(),this.paymentService=Covidence.paymentService,this.pinApi=new Pin.Api(this.paymentService.get("public_api_key"),this.paymentService.get("environment")),this.pinApi.createCardToken(this.creditCard.attributes).then(this.handleSuccess,this.handleError).done(),this.$(".pay").prop("disabled",!0),this},o.prototype.cancelPurchase=function(){return this.model.set({selected_plan:null}),this.model.trigger("cancelPayment"),this},o.prototype.handleSuccess=function(e){var t,n,o;return n=this.model.get("promotion")?this.model.get("promotion").get("id"):null,t=new Covidence.Payment({card_token:e.token,plan_id:this.model.get("selected_plan").get("id"),promotion_id:n}),this.model.set({payment:t}),this.listenToOnce(t,"sync",(o=this,function(){return o.model.trigger("submitSuccess")})),t.save(),this},o.prototype.handleError=function(e){var t;return this.$(".pay").prop("disabled",!1),_(e.messages).each((t=this,function(e){return t.$(".form-group."+e.param).addClass("has-error"),t.$("."+e.param+" .error").html(e.message)})),this},o.prototype.clearErrorMessages=function(){return this.$(".form-group").removeClass("has-error"),this.$(".error").html(""),this},o}()},60482:function(){var e={}.hasOwnProperty;Covidence.PlanPurchaseWizard=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.View),n.prototype.initialize=function(e){return this.completeUrl=e.completeUrl,this.title=e.title||"",this.model=new Backbone.Model({plans:e.plans,account:e.account}),this.listenTo(this.model,"change:selected_plan",this.updateTitleToPlan),this.listenTo(this.model,"choosePlan",this.showPlanPaymentView),this.listenTo(this.model,"submitSuccess",this.submitSuccess),this.listenTo(this.model,"cancelPayment",this.cancelPayment),this.listenTo(this.model,"paymentSuccess",this.paymentSuccess),this.listenTo(this.model,"paymentFailure",this.paymentFailure),this.listenTo(this.model,"complete",this.complete),this.listenTo(this.model,"start",this.start),this.listenTo(this.model,"abort",this.abort),this.currentView=new Covidence.PlansView({model:this.model,title:this.title})},n.prototype.render=function(){return this.renderView(this.currentView),this},n.prototype.showPlanPaymentView=function(){return this.renderView(new Covidence.PlanPaymentView({model:this.model,promotions:Covidence.promotions})),this},n.prototype.submitSuccess=function(){return this.renderView(new Covidence.PlanPaymentStatusView({model:this.model})),this},n.prototype.cancelPayment=function(){return this.renderView(new Covidence.PlansView({model:this.model})),this},n.prototype.paymentSuccess=function(){return this.model.get("account").fetch(),this.renderView(new Covidence.PlanPaymentSuccessView({model:this.model})),this},n.prototype.paymentFailure=function(){return this.renderView(new Covidence.PlanPaymentFailureView({model:this.model})),this},n.prototype.complete=function(e){return this.trigger("complete",e)},n.prototype.abort=function(){return window.location.href="/"},n.prototype.start=function(){var e;return(e=this.model.get("plans").get(Covidence.selectedPlanId||-1))?(this.model.set({selected_plan:e}),this.model.trigger("choosePlan")):this.render()},n.prototype.setHeading=function(e){return $(".navigation__secondary__top__title h2").text(e)},n.prototype.updateTitleToPlan=function(e,t){var n;return t?(n=t.get("name"),this.setHeading("Buy a "+n+" plan")):this.setHeading("Buy a plan")},n.prototype.renderView=function(e){return this.currentView&&this.currentView.remove(),this.currentView=e,this.$el.html(this.currentView.render().el),this},n}()},30047:function(){var e={}.hasOwnProperty;Covidence.PlansPurchaseRouter=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.Router),n.prototype.initialize=function(e){var t,n;return t=e.plans,this.completeUrl=e.completeUrl,this.fromSignup=e.fromSignup,n=new Covidence.PlanPurchaseWizard({el:"#wizard",plans:t,account:Covidence.account}),this.listenTo(n,"complete",this.complete),n.start()},n.prototype.complete=function(e){return this.fromSignup?window.location.replace(this.completeUrl+"?ref=signup_"+e.toLowerCase()):window.location.replace(this.completeUrl)},n}()},66356:function(){var e=function(e,n){for(var o in n)t.call(n,o)&&(e[o]=n[o]);function r(){this.constructor=e}return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e},t={}.hasOwnProperty;Covidence.PlansView=function(t){function n(){var e,t;return this.render=(e=this.render,t=this,function(){return e.apply(t,arguments)}),n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="choose-a-plan",n.prototype.initialize=function(e){return this.template=HandlebarsTemplates["plans/plans"],this.title=e.title},n.prototype.render=function(){var e,t,n,o;return e=this.model.get("account"),this.$el.html(this.template({title:this.title,planUpgradeMotivation:e.planUpgradeMotivation()})),n=this.model.get("plans"),t=Math.floor(75/n.length),n.each((o=this,function(e){var n,r,i,s,a;return a=new Covidence.PlanView({model:e,state:o.model,columnWidth:t}),o.listenToOnce(a,"complete",(function(){return o.trigger("complete")})),o.$el.find(".plans .costing").append(a.render().el),s=new Covidence.PlanValuePropositionView({model:e,columnWidth:t}),o.$el.find(".plans .who-is-it-for").append(s.render().el),o.$el.find(".plans .number-of-project-owners").append('<td class="plan-cell">1</td>'),r=new Covidence.PlanNumberOfReviewsView({model:e,columnWidth:t}),o.$el.find(".plans .number-of-reviews").append(r.render().el),n=new Covidence.PlanNumberOfReviewersView({model:e,columnWidth:t}),o.$el.find(".plans .collaborators-on-reviews").append(n.render().el),i=new Covidence.PlanExpiryView({model:e,columnWidth:t}),o.$el.find(".plans .expiry").append(i.render().el)})),this.$el.append(new Covidence.PlanInclusionsView({collection:Covidence.planInclusions}).render().el),this},n}(Backbone.View),Covidence.PlanCellView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="plan-cell",n.prototype.tagName="td",n.prototype.initialize=function(e){return this.columnWidth=e.columnWidth},n.prototype.render=function(){return this.$el.html(this.content()),this.$el.css("width",this.columnWidth+"%"),!0===this.model.get("custom")&&this.$el.addClass("custom"),this.postRender(),this},n.prototype.content=function(){return""},n.prototype.postRender=function(){},n}(Backbone.View),Covidence.PlanView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="plan",n.prototype.events={"click .choose-plan":"choosePlan"},n.prototype.initialize=function(e){return n.__super__.initialize.call(this,e),this.state=e.state,this.account=this.state.get("account"),this.template=HandlebarsTemplates["plans/plan"]},n.prototype.content=function(){var e;return e=accounting.formatMoney(this.model.get("price"),{precision:0}),this.template({name:this.model.get("name"),price:e})},n.prototype.postRender=function(){return this.account.canPurchasePlan(this.model)||this.$el.find(".choose-plan").prop("disabled","disabled"),this.account.get("current_plan")===this.model&&this.$el.find(".choose-plan").html("Current Plan"),this},n.prototype.choosePlan=function(){return this.state.set({selected_plan:this.model}),Covidence.selectedPlanId=this.model.id,this.state.trigger("choosePlan"),this},n}(Covidence.PlanCellView),Covidence.PlanValuePropositionView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.content=function(){return this.model.get("value_proposition")},n}(Covidence.PlanCellView),Covidence.PlanNumberOfReviewsView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e){return this.template=HandlebarsTemplates["plans/number_of_reviews"]},n.prototype.content=function(){var e,t;return e=this.model.get("number_of_reviews")||"Unlimited",t=!0===this.model.get("renewable"),this.template({numberOfReviews:e,renewable:t})},n}(Covidence.PlanCellView),Covidence.PlanNumberOfReviewersView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.content=function(){return this.model.get("number_of_reviewers")||"Unlimited"},n}(Covidence.PlanCellView),Covidence.PlanExpiryView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.content=function(){return"12 months <br /> (from payment date)"},n}(Covidence.PlanCellView),Covidence.InclusionView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="inclusion row",n.prototype.initialize=function(e){return this.template=HandlebarsTemplates["plans/inclusion"]},n.prototype.render=function(){return this.$el.html(this.template({title:this.model.title,content:this.model.content})),this},n}(Backbone.View)},47156:function(){var e={}.hasOwnProperty;Covidence.PromotionView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.View),n.prototype.className="promotion text-left",n.prototype.events={"click .apply-promotion":"applyPromotion"},n.prototype.initialize=function(e){return this.template=HandlebarsTemplates["plans/promotion"],this.listenTo(this.collection,"sync",this.toggleVisibility),this.collection.fetch()},n.prototype.render=function(){return this.$el.html(this.template()),this.toggleVisibility(),this},n.prototype.toggleVisibility=function(){return this.collection.isEmpty()?this.hide():this.show(),this},n.prototype.show=function(){return this.$el.show(),this},n.prototype.hide=function(){return this.$el.hide(),this},n.prototype.applyPromotion=function(){var e,t,n;return t=this.$(".promo_code").val().trim(),n=this.collection.find((function(e){return e.get("code").toLowerCase()===t.toLowerCase()})),this.$(".promo-message").show(),n?(e=100*n.get("percentage_discount"),this.$(".promo-message").html("Awesome! A "+e+"% discount has been successfully applied."),this.$(".promo-message").removeClass("alert-danger"),this.$(".promo-message").addClass("alert-success"),this.calculateDiscountedPrice(n)):(this.$(".promo-message").html("The promo code you entered is invalid."),this.$(".promo-message").removeClass("alert-success"),this.$(".promo-message").addClass("alert-danger")),this},n.prototype.calculateDiscountedPrice=function(e){var t,n;return n=this.model.get("selected_plan"),t=Math.round(100*n.get("price")*(1-e.get("percentage_discount")))/100,this.model.set({discounted_price:t,promotion:e}),this},n}()},81162:function(e,t,n){"use strict";n.r(t);var o=n(14754),r=function(e,t){return function(){return e.apply(t,arguments)}},i={}.hasOwnProperty;Covidence.S3DirectUploadView=function(e){function t(){return this.onUploadDone=r(this.onUploadDone,this),this.onUploadAdd=r(this.onUploadAdd,this),t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype}(t,Backbone.View),t.prototype.className="s3-direct-upload-view",t.prototype.progressBarTarget=".uploads-container",t.prototype.template=function(){return'<div class="upload-container">\n  <input type="file" name="file" class="direct-file-upload" multiple="multiple"/>\n</div>\n\n<ul class="uploads-container"></ul>\n\n<script id="template-upload" type="text/html">\n  <li id="upload_{{file.unique_id}}">\n    <div class="progress progress-striped active">\n      <h6>{{file.name}}</h6>\n      <div class="bar" style="width: 0%"/>\n      <a href=\'javascript:void(0)\' class=\'result\'></a>\n    </div>\n    <div class=\'error\'></div>\n  </li>\n<\/script>'},t.prototype.events={"click a.result.error":"removeContext"},t.prototype.initialize=function(e){return this.settings=_.extend({allow_multiple_files:!0},e),this.filesToProcess=0,this.filesUploaded=0,this.pendoTrack=o.R0},t.prototype.render=function(){var e;return this.$el.empty(),this.$el.append(this.template()),$.get("/documents/storage_config.json",(e=this,function(t){return _.extend(e.settings,t),e.setupJQueryFileUpload()})).fail((function(e,t,n){})),this},t.prototype.removeContext=function(e){return $(e.currentTarget).parents("li").remove()},t.prototype.onUploadAdd=function(e,t){var n;return this.filesToProcess+=1,this.filesUploaded+=1,(n=t.files[0]).unique_id=Math.random().toString(36).substr(2,16),$("#template-upload").length>0&&(t.context=$($.trim($.mustache($("#template-upload").html(),{file:n}))),$(t.context).appendTo(this.$(this.progressBarTarget))),t.submit()},t.prototype.onUploadDone=function(e,t){var n;return this.filesToProcess-=1,t.files[0],(n=new Covidence.Document({file:t.files[0],attachable_id:this.settings.attachableId,attachable_type:this.settings.attachableType})).url=this.settings.callback_url,this.listenTo(n,"sync",(function(){return t.context.find(".result").addClass("ss-check").addClass("success")})),this.listenTo(n,"invalid",(function(e,n,o){var r,i;for(i in r="",n)r=r+"\n"+i+" - "+n[i];return t.context.find(".error").text(r),t.context.find(".result").addClass("ss-delete").addClass("error")})),n.save(),this.filesToProcess<1&&(this.pendoTrack({uploadMethod:o.GR.LEGACY_SINGLE_STUDY_MODAL,fileCount:this.filesUploaded}),this.filesUploaded=0),this},t.prototype.setupJQueryFileUpload=function(){var e,t,n;return e=this.$(".upload-container"),t=this.settings,e.fileupload({url:this.settings.url,type:"POST",formData:function(){var e,n;return e=[],t.formData.key=t.formData.key.replace(":attachable_id",t.attachableId),t.formData.key=t.formData.key.replace(":attachable_type",t.attachableType),$.each(t.formData,(function(t,n){return e.push({name:t,value:n})})),n="","type"in this.files[0]&&(n=this.files[0].type),e.push({name:"Content-Type",value:n}),e},add:this.onUploadAdd,progress:function(e,t){var n;if(t.context)return n=parseInt(t.loaded/t.total*100,10),t.context.find(".bar").css("width",n+"%")},done:this.onUploadDone,fail:(n=this,function(e,t){if(n.buildData(t).error_thrown=t.errorThrown,t.context)return t.context.find(".result").addClass("ss-delete").addClass("error")})}),e.bind("fileuploadstart",function(e){return function(){return e.trigger("fileuploadstart",e)}}(this)),e.bind("fileuploaddone",function(e){return function(){return e.trigger("fileuploaddone",e)}}(this))},t}()},37140:function(){var e={}.hasOwnProperty;Covidence.SystemErrorView=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.View),n.prototype.id="ajax-error-view",n.prototype.template403="<div class='container'>\n  <span class='message'>\n    Oops, you tried to do something you weren't really allowed to do.\n  </span>\n  <a href='javascript:void(0)' class='dismiss ss-delete'></a>\n</div>",n.prototype.template400="<div class='container'>\n  <span class='message'>\n    Oops, something went wrong. Please <a href='javascript:window.location.reload()'>refresh</a>\n    your page and <a href='javascript:void(0)' data-target='#feedback-and-support' data-toggle='modal'>contact support</a>\n    if the problem persists.\n  </span>\n  <a href='javascript:void(0)' class='dismiss ss-delete'></a>\n</div>",n.prototype.events={"click a":"remove"},n.prototype.render=function(){switch(this.model.response.status){case 400:case 500:this.show400();break;case 403:this.show403()}return this},n.prototype.show400=function(){return this.$el.html(this.template400)},n.prototype.show403=function(){return this.$el.html(this.template403)},n}()},87609:function(){var e={}.hasOwnProperty;Covidence.Wizard=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return function(t,n){for(var o in n)e.call(n,o)&&(t[o]=n[o]);function r(){this.constructor=t}r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype}(n,Backbone.View),n.prototype.initialize=function(e){return this.steps=e.steps||new Backbone.Collection,this.currentStep=0},n.prototype.render=function(){return this.currentView=this.getCurrentView(),this.listenToOnce(this.currentView,"complete",this.nextView),this.listenToOnce(this.currentView,"cancel",this.previousView),this.$el.html(this.currentView.render().el),this},n.prototype.nextView=function(){return this.currentView.remove(),this.currentStep+=1,this.render(),this},n.prototype.previousView=function(){return this.currentView.remove(),this.currentStep-=1,this.render(),this},n.prototype.getCurrentView=function(){return new(this.steps.at(this.currentStep).get("view"))({model:this.state})},n}()},80452:function(){Covidence.UserNotificationView={initialize:function(){var e;return this.el=$("#user-notification-view"),this.el.find("a").on("click",(e=this,function(){return e.hide()})),this.show()},hide:function(){return this.el.hide(),$.cookie("user-notification","seen",{expires:1})},show:function(){if(!$.cookie("user-notification"))return this.el.show()}}},3915:function(e,t,n){n(10474),n(80452),n(96660),n(83630),n(29513),n(8741),n(67624),n(91065),n(53238),n(28200),n(6784),n(41303),n(81812),n(81006),n(92714),n(43016),n(55768),n(89390),n(84299),n(23447),n(81162),n(57270),n(37140),n(75117),n(1971),n(66356),n(47156),n(26392),n(86711),n(2327),n(87609),n(60482),n(30047),$.fn.attachPendingRequestListener=function(e,t){var n=$(this);e.on("ajax:beforeSend",(function(o,r){if("object"==typeof r&&"object"==typeof e&&r.id&&e.id!=r.id)return!1;n.css("position","relative"),n.prepend("<div class='pending-request'>"+(t||"")+"</div>")})).on("ajax:complete",(function(){n.find(".pending-request").remove()}))},$(document).ready((function(){$(document).ajaxSend((function(e,t,n){var o=$("meta[name='csrf-token']").attr("content");t.setRequestHeader("X-CSRF-Token",o)})),$("form.dirty-check").areYouSure(),$("form.dirty-check").on("dirty.areYouSure",(function(){$(".flash_message").text("You have unsaved changes").addClass("unsaved")}))}))},91065:function(){Covidence.Plan=Backbone.RelationalModel.extend({}),Covidence.Plans=Covidence.Collection.extend({model:Covidence.Plan,remote:!0})},14754:function(e,t,n){"use strict";n.d(t,{GR:function(){return a},R0:function(){return l}});var o,r,i,s="covidence.review.full_text_upload",a={LEGACY_SINGLE_STUDY_MODAL:"legacy-single-study-modal",LEGACY_BULK_UPLOADER:"legacy-bulk-uploader",SINGLE_STUDY_MODAL:"single-study-modal",DRAG_AND_DROP_SCREENING_PAGE:"drag-and-drop-screening-page",BULK_UPLOADER:"bulk-uploader",BULK_UPLOADER_SINGLE_FILE:"bulk-uploader-single-file"},c=(i={UPLOAD_METHODS:a},(r=s)in(o={})?Object.defineProperty(o,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[r]=i,function(e,t){"undefined"==typeof pendo?console.log("Sending event "+e+" with: "+JSON.stringify(t)):pendo.track(e,t)}),l=function(e){var t=e.uploadMethod,n=e.fileCount;c(s,{full_text_upload_method:t,total_full_text_uploaded:void 0===n?1:n})}}},function(e){var t;t=3915,e(e.s=t)}]);
//# sourceMappingURL=application.eb93b3bf6afdb741543d.js.map